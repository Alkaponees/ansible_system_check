<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>System Report - {{ inventory_hostname }}</title>

  <style>
    body {
      font-family: system-ui, sans-serif;
      background: #0f172a;
      color: #e5e7eb;
      padding: 20px;
      line-height: 1.5;
    }
    h1 {
      color: #38bdf8;
      margin-bottom: 5px;
    }
    .meta {
      font-size: 0.9rem;
      color: #94a3b8;
      margin-bottom: 20px;
    }
    h2 {
      color: #a5b4fc;
      border-bottom: 1px solid #1e293b;
      padding-bottom: 4px;
      margin-top: 28px;
      cursor: pointer;
    }
    pre {
      background: #020617;
      padding: 12px;
      border-radius: 8px;
      overflow-x: auto;
      white-space: pre-wrap;
    }
    .section {
      margin-bottom: 20px;
    }
    .content {
      display: none;
      margin-top: 10px;
    }
  </style>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      document.querySelectorAll("h2").forEach(h2 => {
        h2.addEventListener("click", () => {
          const next = h2.nextElementSibling;
          next.style.display = next.style.display === "block" ? "none" : "block";
        });
      });
    });
  </script>

</head>

<body>
  <h1>System Report â€“ {{ inventory_hostname }}</h1>
  <div class="meta">
    Generated at: {{ ansible_date_time.iso8601 }}
  </div>

  {% macro section(title, content) %}
    <div class="section">
      <h2>{{ title }}</h2>
      <div class="content">
        <pre>{{ content | default('No data available') }}</pre>
      </div>
    </div>
  {% endmacro %}

  {{ section("CPU Information", cpuinfo.stdout) }}
  {{ section("Memory Usage (free -m)", meminfo.stdout) }}
  {{ section("Disk Usage (df -h /)", diskinfo.stdout) }}
  {{ section("Inode Usage (df -i)", inodeinfo.stdout) }}
  {{ section("SMART Disk Health", smart_status.stdout) }}
  {{ section("System Load (uptime)", loadinfo.stdout) }}
  {{ section("Running Services", servicesinfo.stdout) }}
  {{ section("Network Interfaces", net_interfaces.stdout) }}
  {{ section("DNS Resolution", dns_test.stdout) }}
  {{ section("Ping Test", ping_test.stdout) }}
  {{ section("Open Ports (ss -tulpn)", ports.stdout) }}
  {{ section("Available Updates", updates.stdout) }}
  {{ section("System Errors (journalctl -p 3 -n 50)", sys_errors.stdout) }}
  {{ section("Authentication Log", auth_errors.stdout) }}

</body>
</html>
